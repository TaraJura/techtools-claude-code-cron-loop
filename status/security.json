{
  "_comment": "This file is OVERWRITTEN each security review. Do NOT append to it.",
  "last_review": "2026-01-21T23:19:36Z",
  "status": "secure",
  "ssh_attacks": {
    "total_failed_attempts": 25563,
    "unique_ips": 650,
    "top_attackers": [
      {"ip": "185.246.130.20", "attempts": 2662},
      {"ip": "151.80.144.159", "attempts": 2313},
      {"ip": "66.116.226.147", "attempts": 1112},
      {"ip": "165.245.131.19", "attempts": 796},
      {"ip": "92.118.39.62", "attempts": 780}
    ],
    "attack_rate_per_hour": 400,
    "change_since_last": "+192 attempts since last review (46 min ago)"
  },
  "web_protections": {
    "git_blocked": true,
    "env_blocked": true,
    "sh_blocked": true,
    "py_blocked": true,
    "log_blocked": true,
    "md_blocked": true,
    "claude_md_blocked": true,
    "path_traversal_blocked": true,
    "url_encoded_traversal_blocked": true,
    "all_returning_404": true
  },
  "file_permissions": {
    "claude_md": "664",
    "ssh_dir": "700",
    "ssh_key": "600"
  },
  "disk_usage": "6%",
  "checks_passed": [
    "no_symlinks_in_webroot",
    "nginx_blocks_git_404",
    "nginx_blocks_env_404",
    "nginx_blocks_claude_md_404",
    "nginx_blocks_sh_404",
    "nginx_blocks_py_404",
    "nginx_blocks_log_404",
    "nginx_blocks_md_404",
    "sensitive_file_permissions_correct",
    "path_traversal_blocked",
    "url_encoded_path_traversal_blocked",
    "disk_space_ok",
    "no_exposed_secrets_in_js",
    "no_secrets_committed_to_git"
  ],
  "known_issues": [
    "World-writable API files (action-queue.json, action-status.json, postmortems.json) - required for CGI, mitigated by whitelist validation",
    "tasks.md in webroot intentionally exposed for task viewer feature - contains non-sensitive task data only",
    "Git history contains pattern matches for secret-like keywords - audit confirms these are search patterns in scripts (secrets-audit.sh), not actual credentials"
  ],
  "notes": [
    "Total failed SSH attempts: 25563 (+192 since last review 46 min ago)",
    "Unique attacking IPs: 650 (accurate count after log parsing fix)",
    "Attack rate steady at ~400/hour",
    "Top attacker: 185.246.130.20 with 2662 attempts",
    "All nginx protections verified - all sensitive file types return 404",
    "Path traversal blocked (direct returns 404, URL-encoded returns 400)",
    "SSH key permissions correct (600), SSH dir correct (700)",
    "Disk usage healthy at 6%",
    "sw.js contains cache entries for secrets-audit page, not actual secrets"
  ],
  "recommendations": [
    "CRITICAL: Install fail2ban for SSH protection - 25k+ attacks from 650 IPs",
    "Enable UFW firewall to restrict unnecessary ports",
    "Consider rate limiting on web endpoints"
  ]
}
