{
  "_comment": "This file is OVERWRITTEN each security review. Do NOT append to it.",
  "last_review": "2026-01-23T20:16:43Z",
  "status": "secure",
  "ssh_attacks": {
    "total_failed_attempts": 45270,
    "unique_ips": 897,
    "top_attackers": [
      {"ip": "185.246.130.20", "attempts": 3369},
      {"ip": "151.80.144.159", "attempts": 2547},
      {"ip": "66.116.226.147", "attempts": 840},
      {"ip": "146.190.232.126", "attempts": 607},
      {"ip": "195.178.110.30", "attempts": 537}
    ],
    "attack_rate_per_hour": 348,
    "change_since_last": "+696 attempts since last review (~2 hours ago)"
  },
  "web_protections": {
    "git_blocked": true,
    "env_blocked": true,
    "sh_blocked": true,
    "py_blocked": true,
    "log_blocked": true,
    "md_blocked": true,
    "claude_md_blocked": true,
    "path_traversal_blocked": true,
    "url_encoded_traversal_blocked": true,
    "all_returning_404": true
  },
  "file_permissions": {
    "claude_md": "664",
    "ssh_dir": "700",
    "ssh_key": "600"
  },
  "disk_usage": "6%",
  "checks_passed": [
    "no_symlinks_in_webroot",
    "no_git_files_in_webroot",
    "nginx_blocks_git_404",
    "nginx_blocks_env_404",
    "nginx_blocks_claude_md_404",
    "nginx_blocks_sh_404",
    "nginx_blocks_py_404",
    "nginx_blocks_log_404",
    "nginx_blocks_md_404",
    "sensitive_file_permissions_correct",
    "path_traversal_blocked",
    "url_encoded_path_traversal_blocked",
    "no_secrets_in_recent_commits",
    "disk_space_ok"
  ],
  "known_issues": [
    "World-writable API files (action-queue.json, action-status.json, postmortems.json) - required for CGI, mitigated by whitelist validation",
    "tasks.md in webroot intentionally exposed for task viewer feature - contains non-sensitive task data only",
    "Git history contains pattern matches for secret-like keywords - audit confirms these are search patterns in scripts (secrets-audit.sh), not actual credentials"
  ],
  "notes": [
    "Total failed SSH attempts: 45270 (up from 44574 in last review)",
    "Unique attacking IPs: 897 (corrected count using grep -oP extraction)",
    "Previous review showed 6941 unique IPs due to incorrect awk field extraction",
    "Top attacker 185.246.130.20 increased from 2513 to 3369 attempts (+856)",
    "Top attacker 151.80.144.159 increased from 2004 to 2547 attempts (+543)",
    "New attacker in top 5: 66.116.226.147 with 840 attempts",
    "All nginx protections verified - all sensitive file types return 404",
    "Path traversal blocked (direct returns 404, URL-encoded returns 400)",
    "SSH key permissions correct (600), SSH dir correct (700)",
    "No secrets found in recent git commits",
    "Disk usage healthy at 6%"
  ],
  "recommendations": [
    "CRITICAL: Install fail2ban for SSH protection - 45k+ total attacks from 897 unique IPs",
    "Enable UFW firewall to restrict unnecessary ports",
    "Consider rate limiting on web endpoints"
  ]
}
